"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[2156],{8453:(e,n,t)=>{t.d(n,{R:()=>a,x:()=>o});var s=t(6540);const r={},i=s.createContext(r);function a(e){const n=s.useContext(i);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),s.createElement(i.Provider,{value:n},e.children)}},9058:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>d,frontMatter:()=>a,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"Security/protectingserver","title":"Protecting Your Server","description":"Fail2ban","source":"@site/docs/05-Security/protectingserver.md","sourceDirName":"05-Security","slug":"/Security/protectingserver","permalink":"/cashu-mint-docs/docs/Security/protectingserver","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"sidebar_position":3},"sidebar":"tutorialSidebar","previous":{"title":"Limit Access to your Mint","permalink":"/cashu-mint-docs/docs/Security/limitingaccessmint"},"next":{"title":"Monitoring Your Mint","permalink":"/cashu-mint-docs/docs/Security/monitoring"}}');var r=t(4848),i=t(8453);const a={sidebar_position:3},o="Protecting Your Server",l={},c=[{value:"Fail2ban",id:"fail2ban",level:2},{value:"Set Up UFW",id:"set-up-ufw",level:2}];function u(e){const n={code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"protecting-your-server",children:"Protecting Your Server"})}),"\n",(0,r.jsx)(n.h2,{id:"fail2ban",children:"Fail2ban"}),"\n",(0,r.jsx)(n.p,{children:"Fail2Ban is an intrusion prevention software framework designed to prevent brute-force attacks by monitoring log files for selected entries and running scripts based on them."}),"\n",(0,r.jsx)(n.p,{children:"This is a fail2ban config that works with Nutshell running as a systemd service called nutshell.service."}),"\n",(0,r.jsx)(n.p,{children:"This is the jail file /etc/fail2ban/jail.d/nutshell.conf"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"[nutshell]\nenabled = true\nport = http,https\nfilter = nutshell\nbackend = systemd[journalflags=1]\njournalmatch = _SYSTEMD_UNIT=nutshell.service\nbantime = 1d\nfindtime = 120\nmaxretry = 60\nbanaction = ufw\nThis is the filter file /etc/fail2ban/filter.d/nutshell.conf\n\n[Definition]\nfailregex = ^.*\\| <HOST>:\\d* -.*\nignoreregex =\nHere is an example systemd service file /etc/systemd/system/nutshell.service for nutshell. Please adjust your directories and user names accordingly. In the example below, nutshell is running in the directory /home/cashu/cashuand is run by the user called cashu.\n\n# Systemd unit for Nutshell\n# /etc/systemd/system/nutshell.service\n\n[Unit]\nDescription=nutshell\nWants=nutshell.service\n\n[Service]\nWorkingDirectory=/home/cashu/cashu\nExecStart=/home/cashu/.local/bin/poetry run python -m cashu.mint --port 2338 --host 127.0.0.1\nUser=cashu\nRestart=always\nTimeoutSec=120\nRestartSec=30\nEnvironment=PYTHONUNBUFFERED=1\n\n[Install]\nWantedBy=multi-user.target\n"})}),"\n",(0,r.jsx)(n.h2,{id:"set-up-ufw",children:"Set Up UFW"}),"\n",(0,r.jsx)(n.p,{children:"Uncomplicated Firewall (UFW) is a program designed to manage a netfilter firewall in a simple and easy-to-use manner. I"}),"\n",(0,r.jsx)(n.p,{children:"To allow basic ports:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"sudo apt install ufw -y \nsudo ufw allow ssh\nsudo  ufw default deny incoming\nsudo ufw default allow outgoing\nsudo ufw allow OpenSSH\nsudo ufw allow 80 comment 'Standard Webserver'\nsudo ufw allow 443 comment 'SSL Webserver'\nsudo ufw enable\n"})}),"\n",(0,r.jsx)(n.p,{children:"Check rules"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"sudo ufw status\n"})})]})}function d(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(u,{...e})}):u(e)}}}]);